<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<c:set var="ctx" value="${pageContext.request.contextPath}"/>
<html>
<head>
    <title>查看门店进货信息</title>
</head>
<body>
<input style="display: none" type="hidden" id="storeId" value="${storeId}">
<script>
    $(document).ready(function () {

        $.ajax({
            url: "${ctx}/purchase/selectBranchProfitsByStoreId",
            type: "post",

            success: function (data) {

                $("#profits").val(data);
            }
        });

    })

</script>
<!-- Main Content -->
<div class="page-wrapper">
    <div class="container-fluid">
        <!-- Row -->
        <div class="row">
            <div class="col-sm-12">
                    <div class="panel-heading">
                        <div class="pull-left">
                            <ol class="breadcrumb" style="color: #9b59b6" >
                                <li><a href="${ctx}/index">首页</a></li>
                                <li class="active">分公司查看门店的进货信息</li>
                                &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
                                本月总利润:<input type="text" readonly="readonly" style="text-align:center;padding-right:20px;width:80px ;color: #9b59b6;"
                                           id="profits">
                            </ol>

                        </div>
                        <div class="clearfix"></div>
                    </div>
                    <table id="footable_purchase" class="table" data-paging="true" data-filtering="true"
                           data-sorting="true">

                    </table>
            </div>
        </div>
        <!-- /Row -->

    </div>
</div>

<script>
    $(function () {
        var purchaseTitle = [
            {"name": "id", "title": "ID", "breakpoints": "xs sm", "visible": false},
            {"name": "storeId", "title": "门店id","visible": false},
            {"name": "storeName", "title": "门店名称"},
            {"name": "goodsOrderId", "title": "关联订单id"},
            {"name": "purchaseTime", "title": "入货时间", "style": {"width": 120, "maxWidth": 240}},
            {"name": "employerId", "title": "员工id", "visible": false},
            {"name": "employerName", "title": "员工名称"},
            {"name": "payable", "title": "应付金额"},
            {"name": "details", "title": "详情"}
        ];


        //启动模态框
        var $modal = $('#app-editor-modal'),
            $editor = $('#editor'),
            $editorTitle = $('#editor-title')
        //启动footable
        var ft = FooTable.init('#footable_purchase', {
            "columns": purchaseTitle,
            "rows": $.get("${ctx}/purchase/selectPurchaseByBranchOfficeId", function (data) {
                $(data).each(function () {
                    this.details = "<button id='cx' class='btn btn-primary btn-sm'  onclick='findDetails(" + '"' + this.id + '"' + ")'>点击查看</button>";

                });
                //
                return data;
            }),

        });
    });

    //查询详情
    function findDetails(id) {
        //这里写你的逻辑就行了
        window.location.href = "${ctx}/orderDetails/selectDetailsByOrderId?orderId=" + id + "&detailstype=" + 1;
    }

</script>
</body>
</html>
